from MBVMusic import app
import asyncio
import random
from pyrogram import Client, filters
from pyrogram.enums import ChatType, ChatMemberStatus
from pyrogram.errors import UserNotParticipant
from pyrogram.types import ChatPermissions

spam_chats = []

EMOJI = [
    "??????????",
    "???å∏???ç¨??",
    "???å∑?åπ?å∫??",
    "?å∏?åø?íÆ?å±?åµ",
    "?§Ô????????ñ§",
    "??????????",
    "?å∏???å∫?åπ??",
    "???¶™???ç≤??",
    "?????????å∂Ô∏?,
    "???•§?????ç∑",
    "?ç¨?ç≠?????ç°",
    "?ç®???ç∫?ï??,
    "?•™?•ß?ç¶?ç•??",
    "???ï?π?∑ü•?,
    "?ïüßÉ?©?¶??,
    "???åæ?íÆ???åø",
    "?å®Ô∏è?•Ô??àÔ??å©Ô∏è?ßÔ?",
    "?å∑?èµÔ∏è?∏?∫??,
    "?íÆ?åº?åª????",
    "???¶∏?¶π???ë∏",
    "???????åΩ?•¶",
    "?ê∑?êπ?ê≠?ê®?êª?ç‚?Ô∏?,
    "???????????ç‚?",
    "?åº?å≥?å≤?å¥?åµ",
    "?•©????????",
    "?ç¥?çΩÔ∏è?™?∂ü•?,
    "???è∞?è©?©Ô??è©",
    "??????????",
    "?™¥?åµ?å¥?å≥?å≤",
    "??????????",
    "??????Ô∏èü¶§ü¶?,
    "?¶§?¶©??????",
    "?ê¨?¶≠?????ê≥",
    "???????ê°??",
    "?¶©???????¶™",
    "?ê¶???ï∑Ô∏è?∏Ô???",
    "?•™?ç∞?•ß?ç®?ç®",
    " ?•¨??????",
]

TAGMES = [
    " **?????ê≤ ???????ê≤ ?????ê°?? ???ê®???•±** ",
    " **???ê≤?? ???ê® ???ê≤?? ???ê≤?? ???êß?ê•?ê¢?êß?? ?????ê®??** ",
    " **???? ???ê°???ê•?ê® ?????ê≠???êß ?????ê´?ê≠?? ?????ê¢?êß ???êÆ???ê° ???êÆ???ê°??** ",
    " **???ê°???êß?? ???ê°?? ???ê¢?ê≤?? ???ê¢..???•≤** ",
    " **???ê°???ê´ ???? ?????? ?????ê¢?ê¨?? ?????ê¢?êß ???ê¢?•∫** ",
    " **???ê≠?? ?????ê¢ ???ê®?ê°?ê®?ê≠ ???ê¢?ê¨?ê¨ ?????ê´ ???ê°?ê¢ ???ê°?ê¢ ?????ê©?ê§?ê®?§≠** ",
    " **???ê≤?? ?????ê• ???ê°???ê• ?????ê¨?? ?????ê¢..???§®** ",
    " **?????ê´?ê¢ ???ê°?ê¢ ?????ê≠?ê≠?ê¢?êß?? ?????ê´???? ???ê®????..????** ",
    " **?????ê©?ê§?? ?????ê¶?? ???ê≤?? ?ê°???ê¢..???•≤** ",
    " **?????ê¨?ê≠?? ???êÆ?? ?????ê©?ê§??..????** ",
    " **?????ê´?? ???ê® ???ê©?êß?? ???ê´?ê®?êÆ?ê© ???? ???ê¢???êß???ê© ???ê´ ???ê®??** ",
    " **?????ê©?ê§?ê¢ ?????ê´?ê≠?êß???ê´ ?????ê©?ê§?ê® ???ê°?êÆ?êß?? ???ê°?? ?????ê¢?êß ???ê•???ê¢ ???êß?ê•?ê¢?êß?? ???ê≤?ê¢????????** ",
    " **?????ê´?? ???? ???ê®?ê¨?ê≠?ê¢ ???ê´?ê®????..????** ",
    " **???ê®?êß?? ???ê°???ê• ???ê≤?? ???ê≤??????** ",
    " **???ê§ ???ê®?êß?? ???ê•???ê≤ ???ê´?ê® ???? ???ê•?ê¨?ê¨??** ",
    " **?????ê© ?????ê°?? ???? ???ê®..????** ",
    " **?????ê•?ê•?ê® ???ê¢ ?????ê¶???ê¨?ê≠????** ",
    " **?????ê•?ê•?ê® ???????ê≤ ???ê§?ê´?ê°..???** ",
    " **???ê® ???ê®?êÆ ???êß?ê®?ê∞ ???ê°?ê® ???ê¨ ???ê≤ ???ê∞?êß???ê´.?** ",
    " **???ê°?ê•?ê® ???êÆ???ê° ?????ê¶?? ???ê°???ê•?ê≠?? ?????ê¢?êß.??** ",
    " **???êÆ?ê´ ?????ê≠???ê® ?????ê¢?ê¨?? ???ê® ???????ê≤??** ",
    " **???êÆ?ê¶?ê°???ê´?ê¢ ???êÆ?ê¶?ê¶?ê≤ ???ê≤?? ?????ê´ ?????ê°?ê¢ ?????ê¢?§≠** ",
    " **?????ê´?? ???? ?????ê≠ ???ê®?ê¢ ???ê´?ê®?????•∫?•∫** ",
    " **???ê≤?? ?????????ê• ???êß?ê•?ê¢?êß?? ???? ?????ò∂** ",
    " **?????ê£ ???ê®?ê•?ê¢?????ê≤ ?????ê¢ ???ê≤?? ?????ê°?ê®?ê®?ê• ????..????** ",
    " **???ê≤?? ???ê®?ê®?? ???ê®?ê´?êß?ê¢?êß????** ",
    " **???êÆ?êß?ê® ???ê§ ?????ê¶ ?????ê¢ ???êÆ?ê¶?ê¨????** ",
    " **???ê®?ê¢ ???ê®?êß?? ???ê•???ê≤ ???ê´?ê® ?????ò™** ",
    " **???ê¢???? ???ê® ???????ê≠ ???ê°??* ",
    " **?????ê•?ê•?ê®??** ",
    " **???ê≠?êÆ???ê≤ ???ê®?ê¶?ê•???ê≠?? ???êÆ?????ò∫** ",
    " **???ê®?ê•?ê® ???? ???êÆ???ê° ???ê´?ê´?•≤** ",
    " **???ê®?êß???ê•?ê¢ ???ê®?êß ?????ê¢...????** ",
    " **???êÆ?ê¶?ê°???ê´?ê¢ ???ê§ ???ê¢?? ???ê¢?ê•?????ê¢..???** ",
    " **???êÆ?ê¶?ê¶?ê≤ ???? ???ê≤?ê¢ ???ê≤????????** ",
    " **???ê´ ?????ê≠???ê® ???ê°?????ê°?ê¢ ?????ê¢?ê¨?ê¢ ?????ê¢??** ",
    " **?? ???ê®?êØ?? ???ê®?êÆ??????** ",
    " **???ê® ???ê®?êÆ ???ê®?êØ?? ????..???** ",
    " **?????ê§?ê°?ê¢ ?????? ?????êß?? ?????ê°?ê¢ ???ê®.????** ",
    " **???ê§ ???ê®?êß?? ???êÆ?êß???êÆ..??òπ** ",
    " **???êß?ê•?ê¢?êß?? ???? ???? ???? ???ê®?êß?? ???êÆ?êß?? ?????ê°?ê¢ ???êÆ?òª** ",
    " **???êß?ê¨?ê≠?????ê´???ê¶ ???ê°???ê•???ê≠?? ???ê®..????** ",
    " **???ê°???ê≠?ê¨???ê©?ê© ???êÆ?ê¶?????ê´ ???ê®???? ???ê©?êß?? ???êÆ?ê¶..???** ",
    " **???êÆ?ê¶?ê°?? ???ê®?êß ???? ???êÆ?ê¨?ê¢?? ???êÆ?êß?êß?? ?????ê¨???êß?? ?????ê¢..???** ",
    " **?????ê´?? ?????ê¶ ???ê°???ê≠???ê¶ ???ê® ???ê≤?? ?????ê©?ê§??..???** ",
    " **?????ê°?? ???? ???ê® ?????ê©??** ",
    " **???êÆ?êß?ê® ??????** ",
    " **?????ê´?? ???ê§ ???????ê¶ ?????ê´ ???ê®????..?** ",
    " **???ê≤ ?????ê≠?? ?????ê≠ ?????ê≠ ?????ê´?êß?? ?????ê£ ???? ????????** ",
    " **???ê®?ê¶ ?????? ?????ê¢?ê¨?? ?????ê¢?êß..???* ",
    " **???ê≤?? ???êÆ??..??ë±** ",
    " **???ê®?ê°?ê®?ê≠ ???????? ???? ???ê°?ê¢ ?????ê¢ ?§ß???** ",
    " **???ê°?êÆ?ê• ???ê≤?? ???êÆ?ê£?ê°??????** ",
    " **???êÆ?ê≠?ê° ???ê°?ê¢ ???ê®?ê•?êß?? ???ê°???ê°?ê¢?ê≤????** ",
    " **???ê°?? ???ê® ???ê°???ê∞ ?????ê≠ ???ê´?ê® ???????ê≠??** ",
    " **???ê≤?? ???êÆ???òÆ?òÆ** " " **???ê¢?ê¢??** ",
    " **?????ê©?ê§?? ?????ê¢?ê¨?? ???ê®?ê¨?ê≠ ???ê® ?????ê≠?ê° ???? ???ê¢?ê´ ???êÆ?ê¶ ???ê¢?ê¨ ?????ê≠ ???? ??** ",
    " **?????ê£ ?????ê¢ ?????? ???êÆ ?πÔ?** ",
    " **???êÆ?ê¨?ê£?ê°?ê¨?? ???ê°?ê¢ ?????ê≠ ?????ê´ ???ê® ???? ?•∫?•∫** ",
    " **???ê≤?? ?????ê´ ?????ê°?? ???ê®??** ",
    " **???ê≤?? ?????ê• ???ê°???ê• ?????ê¢ ??** ",
    " **?????ê°?? ???? ???ê® ?????ê©..???** ",
    " **???ê°???ê≠?ê≠?ê¢?êß?? ?????ê´ ???ê® ????..?•∫** ",
    " **???? ?????ê¨?ê®?ê®?ê¶ ???êÆ ?????•∫?•∫** ",
    " **?????ê• ?????ê£?? ???ê≤?? ???ê°?? ?????§≠??** ",
    " **???ê´?ê®?êÆ?ê© ???? ?????ê≠ ???ê≤?êÆ ?????ê°?ê¢ ?????ê´?ê≠?? ???ê®??** ",
    " **?????ê© ?????ê•???ê≠?ê¢?ê®?ê¶?ê¨?ê°?ê¢?ê© ???? ???ê®..???** ",
    " **???ê¢?ê≠?êß?? ???ê°?êÆ?ê© ?????ê°?ê≠?? ???ê® ???ê´?ê´?òº** ",
    " **?????ê©?ê§?ê® ?????êß?? ?????êß?? ?????ê≠?? ?????ê¢..??ò∏** ",
    " **???ê°?êÆ?ê¶?êß?? ???ê°???ê•?ê®????..????** ",
    " **???ê°?êÆ?ê¨ ?????ê°?? ?????ê´?ê® ?åÔ???** ",
    " **?????ê¶ ???ê®?ê¨?ê≠ ?????êß ?????ê§?ê≠?? ?????ê¢...??•∞** ",
    " **???êÆ???ê° ???ê®?ê• ???ê≤?êÆ ???ê°?ê¢ ?????ê°?? ???ê®..?•∫?•∫** ",
    " **???êÆ???ê° ?????ê¶?????ê´?ê¨ ?????? ?????ê´ ???ê® ?•≤** ",
    " **???ê¢?êß???ê•?? ???ê® ???? ???ê¢?êß???ê•?? ??** ",
    " **?????ê® ?????ê´?ê≠?ê≤ ?????ê´?ê≠?? ?????ê¢?êß???•≥** ",
    " **?????ê¶?ê•?ê®?ê®??** ",
    " **???êÆ?ê£?ê°?? ???ê°?êÆ?ê• ???ê≤?? ???ê≤???•∫** ",
    " **?????ê°?? ???? ?????ê®:-[@TG_FRIENDSS]  ?????ê¨?ê≠?ê¢ ?????ê´???êß???? ?§≠?§≠** ",
    " **???ê´?êÆ?ê≠?ê° ???êß?? ?????ê´?? ???ê°???ê•?ê®????..? ??** ",
    " **?????ê£ ???êÆ?ê¶?ê¶?ê≤ ???? ?????ê≠?? ???ê´?•∫?•∫** ",
    " **???ê®?ê¢?êß ?????ê´ ???ê®??** ",
    " **???ê§ ???ê¢?ê• ?????ê¢ ???ê§ ???ê¢?ê• ???ê¢ ???ê® ?????ê¢????** ",
    " **???êÆ?ê¶?ê°???ê´?? ???ê®?ê¨?ê≠ ?????ê°?? ???ê≤???•∫** ",
    " **???ê≤ ???êÆ?ê≠?? ???ê∞?êß???ê´{ @THE_VIP_BOY}?•∞** ",
    " **?????ê°?? ???ê°?ê®?ê≤?? ???ê® ???????êß??** ",
    " **???ê®?ê®?? ??8 ???ê¢ ???ê°?êÆ?ê≠ ?????ê≠ ???ê® ???ê≤?ê¢?•∞** ",
]

VC_TAG = [
    "**?????ô¥ ???ô≤ ???ô∞?ôæ ???ô∞ ???ôª???•≤**",
    "**???ôæ?ô∏?ôΩ ???ô≤ ???ô∞???? ?????? ???ôº?ô∞?ôø?ôæ?????ô∞?ôΩ???ò¨**",
    "**???ôæ?ôº?ô¥ ???ô≤ ?ô±?ô∞?ô±?? ?ôµ?ô∞??????**",
    "**???ô∞?ô±?? ?????ôº ???ô∑?ô∏ ???ô∑?ôæ???ô∞ ???ô≤ ???ô∞?ôΩ?ô∞?•∞**",
    "**?????ô¥ ???ô∑?ô∞?ôº???? ???ô≤ ???ô∞ ???ô∫ ???ô∞?ôº ???ô∞?ô∏?§®**",
    "**?????ôΩ?ôæ ???ô≤ ???ôæ?ô∏?ôΩ ???? ???ôæ?§£**",
    "**???ô≤ ???ô∞ ???ô∞?ô∏???ô¥ ???ô∫ ???ô∞????**",
    "**???ô≤ ???ô∞?ôø?ô∫?ôæ ???ô∞?ôº?ô¥ ???ô∑?ô∞?ôª?? ???ô∞?ô∏??*",
    "**???ô≤ ???ô∞?ôæ ???ô∞???ôΩ?ô∞ ???ô∞?ôΩ ???ôæ ???ô∞?ôæ?ô∂?ô¥?•∫**",
    "**???ôæ?????? ???ô∞?ô±?? ???ôª?? ???ô≤ ???ô∞ ???ô∞?ôæ ???ô∞?ò•**",
    "**???ô≤ ???ô∞?ôΩ?ô∞ ???ô∫ ???ô∑?ô∏?ôπ ???ô∏?ô∫?ô∑?ô∞???ô∏ ??????**",
    "**???ô≤ ???ô¥ ???ô∑?ô¥?ô≤?ô∫ ?????ô∫?ô¥ ???ô∞???ô∞?ôæ ???ôæ ???ôæ?ôΩ?ô∂ ???ôª?ô∞?? ???ôæ ???ô∑?ô∞ ?????**",
    "**???ô≤ ???ôæ?ô∏?ôΩ ?????ôΩ?ô¥ ???ô¥ ?????ô∞ ???ô∞???ô∞ ?? ???ô∑?ôæ???ô∞ ???ô¥?? ???ô∞?? ???ôæ ???ô∞??**",
]


@Client.on_message(filters.command(["tagall"], prefixes=["/", "@", ".", "#"]))
async def mentionall(client, message):
    chat_id = message.chat.id
    if message.chat.type == ChatType.PRIVATE:
        return await message.reply("???ê°?ê¢?ê¨ ???ê®?ê¶?ê¶???êß?? ???êß?ê•?ê≤ ???ê®?ê´ ???ê´?ê®?êÆ?ê©?ê¨.")

    is_admin = False
    try:
        participant = await client.get_chat_member(chat_id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (
            ChatMemberStatus.ADMINISTRATOR,
            ChatMemberStatus.OWNER,
        ):
            is_admin = True
    if not is_admin:
        return await message.reply(
            "???ê®?êÆ ???ê´?? ???ê®?ê≠ ?????ê¶?ê¢?êß ???????ê≤, ???êß?ê•?ê≤ ?????ê¶?ê¢?êß?ê¨ ?????êß ?????? ?????ê¶?????ê´?ê¨. "
        )

    if message.reply_to_message and message.text:
        return await message.reply(
            "/tagall ???ê®?ê®?? ???ê®?ê´?êß?ê¢?êß?? ?? ???ê≤?ê©?? ???ê¢?ê§?? ???ê°?ê¢?ê¨ / ?????ê©?ê•?ê≤ ???êß?ê≤ ?????ê¨?ê¨?????? ?????ê±?ê≠ ???ê¢?ê¶?? ???ê®?ê≠ ?????????ê¢?êß??..."
        )
    elif message.text:
        mode = "text_on_cmd"
        msg = message.text
    elif message.reply_to_message:
        mode = "text_on_reply"
        msg = message.reply_to_message
        if not msg:
            return await message.reply(
                "/tagall ???ê®?ê®?? ???ê®?ê´?êß?ê¢?êß?? ?? ???ê≤?ê©?? ???ê¢?ê§?? ???ê°?ê¢?ê¨ / ?????ê©?ê•?ê≤ ???êß?ê≤ ?????ê¨?ê¨?????? ?????ê±?ê≠ ???ê¢?ê¶?? ???ê®?ê≠ ?????????ê¢?êß??..."
            )
    else:
        return await message.reply(
            "/tagall ???ê®?ê®?? ???ê®?ê´?êß?ê¢?êß?? ?? ???ê≤?ê©?? ???ê¢?ê§?? ???ê°?ê¢?ê¨ / ?????ê©?ê•?ê≤ ???êß?ê≤ ?????ê¨?ê¨?????? ?????ê±?ê≠ ???ê¢?ê¶?? ???ê®?ê≠ ?????????ê¢?êß??..."
        )
    if chat_id in spam_chats:
        return await message.reply(
            "???ê•?????ê¨?? ???ê≠ ???ê¢?ê´?ê¨?ê≠ ???ê≠?ê®?ê© ???êÆ?êß?êß?ê¢?êß?? ?????êß?ê≠?ê¢?ê®?êß ???ê´?ê®?????ê¨?ê¨ ???ê≤ /tagalloff , /stopvctag ..."
        )
    spam_chats.append(chat_id)
    usrnum = 0
    usrtxt = ""
    async for usr in client.get_chat_members(chat_id):
        if not chat_id in spam_chats:
            break
        if usr.user.is_bot:
            continue
        usrnum += 1
        usrtxt += f"[{usr.user.first_name}](tg://user?id={usr.user.id}) "

        if usrnum == 1:
            if mode == "text_on_cmd":
                txt = f"{usrtxt} {random.choice(TAGMES)}\n\n|| ??·¥è“ì“?·¥õ·?…¢…¢…™…¥…¢ ?? ¬ª /stoptagall ||"
                await client.send_message(chat_id, txt)
            elif mode == "text_on_reply":
                await msg.reply(f"[{random.choice(EMOJI)}](tg://user?id={usr.user.id})")
            await asyncio.sleep(4)
            usrnum = 0
            usrtxt = ""
    try:
        spam_chats.remove(chat_id)
    except:
        pass


@Client.on_message(filters.command(["vctag"], prefixes=["/", ".", "@", "#"]))
async def mention_allvc(client, message):
    chat_id = message.chat.id
    if message.chat.type == ChatType.PRIVATE:
        return await message.reply("???ê°?ê¢?ê¨ ???ê®?ê¶?ê¶???êß?? ???êß?ê•?ê≤ ???ê®?ê´ ???ê´?ê®?êÆ?ê©?ê¨.")

    is_admin = False
    try:
        participant = await client.get_chat_member(chat_id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (
            ChatMemberStatus.ADMINISTRATOR,
            ChatMemberStatus.OWNER,
        ):
            is_admin = True
    if not is_admin:
        return await message.reply(
            "???ê®?êÆ ???ê´?? ???ê®?ê≠ ?????ê¶?ê¢?êß ???????ê≤, ???êß?ê•?ê≤ ?????ê¶?ê¢?êß?ê¨ ?????êß ?????? ?????ê¶?????ê´?ê¨. "
        )
    if chat_id in spam_chats:
        return await message.reply(
            "???ê•?????ê¨?? ???ê≠ ???ê¢?ê´?ê¨?ê≠ ???ê≠?ê®?ê© ???êÆ?êß?êß?ê¢?êß?? ?????êß?ê≠?ê¢?ê®?êß ???ê´?ê®?????ê¨?ê¨ ???ê≤ /tagalloff , /stopvctag ..."
        )
    spam_chats.append(chat_id)
    usrnum = 0
    usrtxt = ""
    async for usr in client.get_chat_members(chat_id):
        if not chat_id in spam_chats:
            break
        if usr.user.is_bot:
            continue
        usrnum += 1
        usrtxt += f"[{usr.user.first_name}](tg://user?id={usr.user.id}) "

        if usrnum == 1:
            txt = f"{usrtxt} {random.choice(VC_TAG)}\n\n|| ??·¥è“ì“?·¥õ·?…¢…¢…™…¥…¢ ?? ¬ª /stopvctag ||"
            await client.send_message(chat_id, txt)
            await asyncio.sleep(4)
            usrnum = 0
            usrtxt = ""
    try:
        spam_chats.remove(chat_id)
    except:
        pass


@Client.on_message(
    filters.command(
        [
            "stoptagall",
            "canceltagall",
            "offtagall",
            "tagallstop",
            "stopvctag",
            "tagalloff",
        ]
    )
)
async def cancel_spam(client, message):
    if not message.chat.id in spam_chats:
        return await message.reply("???êÆ?ê´?ê´???êß?ê≠?ê•?ê≤ ??'?ê¶ ???ê®?ê≠ ?????????ê¢?êß?? ???????ê≤.")
    is_admin = False
    try:
        participant = await client.get_chat_member(
            message.chat.id, message.from_user.id
        )
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (
            ChatMemberStatus.ADMINISTRATOR,
            ChatMemberStatus.OWNER,
        ):
            is_admin = True
    if not is_admin:
        return await message.reply(
            "???ê®?êÆ ???ê´?? ???ê®?ê≠ ?????ê¶?ê¢?êß ???????ê≤, ???êß?ê•?ê≤ ?????ê¶?ê¢?êß?ê¨ ?????êß ?????? ?????ê¶?????ê´?ê¨."
        )
    else:
        try:
            spam_chats.remove(message.chat.id)
        except:
            pass
        return await message.reply("?????ê≠?ê®?ê©?ê©????..??)
